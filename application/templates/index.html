{% extends "layout-simple.html" %}

{% block headstyles %}
<style>
.footer {
    //text-align: right;
    //visibility: hidden;
}
.btn-file {
  position: relative;
  overflow: hidden;
}
.btn-file input[type=file] {
  position: absolute;
  top: 0;
  right: 0;
  min-width: 100%;
  min-height: 100%;
  font-size: 100px;
  text-align: right;
  filter: alpha(opacity=0);
  opacity: 0;
  background: red;
  cursor: inherit;
  display: block;
}
input[readonly] {
  background-color: white !important;
  cursor: text !important;
}
</style>
{% endblock %}

{% block headscripts %}
<noscript>Sorry: To work properly, this page requires JavaScript.</noscript>
{% endblock %}

{% block content %}
<div class="container-fluid">
  <div class="row">
    <div class="hidden">
      <h1>{{ title }}</h1>
    </div>
    <span id="out">
    </span>
  </div>

  {% if not message %}
  <div class="hidden">
  {% else %}
  <div class="row">
  {% endif %}
    <div class="crawl" align="center">
      <h1>{{ message }}</h1>
    </div>
  </div>

  {% if not output %}
  <div class="hidden">
  {% endif %}
  <br />
  <div class="row">
    <table class="table table-bordered" width="100%">
      <thead>
        <tr>
          <th></th>
          {% for hword in word_list %}
            <th>{{ hword }}</th>
          {% endfor %}
        </tr>
      </thead>
      {% for row in output %}
        <tr>
          {% for word in row %}
            {% if loop.first %}
              <th>{{ word }}</th>
            {% else %}
              <td>{{ word }}</td>
            {% endif %}
          {% endfor %}
        </tr>
      {% endfor %}
    </table>
  <hr />
  </div>
  {% if not output %}
  </div>
  {% endif %}

  <br />

  <div class="row">
    <div class="col-lg-6 col-sm-6 col-12">
      <p>Choose your CSV file. Note that we expect a header at the top.</p>
      <form action="/" method="POST" class="form-inline" enctype="multipart/form-data">
        <div class="input-group">
            <span class="input-group-btn">
              <span class="btn btn-primary btn-file">
                Browse&hellip; <input id="input-1" type="file" class="btn btn-primary btn-file" name="filename">
              </span>
            </span>
            <input type="text" class="form-control" placeholder="Select a file" readonly>
        </div>
        <br />
        <br />
        <button class="btn btn-lg btn-default" name="uploadData" id="uploadData" type="submit">Upload data</button>
      </form>
    </div>

  </div>

  <hr>
  <br />

  <div class="row">
    <div class="col-sm-6 col-sm-offset-3" align=center>
      <form action="/download">
        <button class="btn btn-lg btn-default" type="submit">Download data</button>
      </form>
    </div>
  </div>


</div>
{% endblock %}

{% block endscripts %}
<script>
$(document).on('change', '.btn-file :file', function() {
  var input = $(this),
      numFiles = input.get(0).files ? input.get(0).files.length : 1,
      label = input.val().replace(/\\/g, '/').replace(/.*\//, '');
  input.trigger('fileselect', [numFiles, label]);
});

$(document).ready( function() {
    $('.btn-file :file').on('fileselect', function(event, numFiles, label) {
        
        var input = $(this).parents('.input-group').find(':text'),
            log = numFiles > 1 ? numFiles + ' files selected' : label;
        
        if( input.length ) {
            input.val(log);
        } else {
            //if( log ) alert(log);
        }
        
    });
});
</script>
{% endblock %}
